<!DOCTYPE html>
<html>
	<head>
	<style>	
		body,html {overflow: none;}
	</style>
	</head>
	<script src="dialogr.js"></script>

	<script>

	var dlg;

		// Call the dialogr ready function to indicate that the dialog
		// is loaded, and to get access to parameters and callback functions
		dialogr.ready().done(function(dialog) {
			dlg = dialog;
			//dlg.buttons.enable();

			console.warn(dialog);

			if (dlg.param.name) 
				document.getElementById('name').value = dlg.param.name;

		document.getElementById('name').onkeydown = function(e) {
			if (e.keyCode == 13) {
				if (document.getElementById('name').value.length > 0) {
					okClick();
				}
			} else if (e.keyCode == 27) {
				dlg.close();
			}
		}


			// Bind button events
			dlg
			.on('button_ok', okClick)
			.on('button_cancel', cancelClick);

		});


		//Clicking OK will resolve and close the dialog
		function okClick() {

			dlg.block();
			dlg.invoke('update_name', document.getElementById('name').value).then(function(e) {
				console.warn("name was updated to", e);
				dlg.resolve();
			}, function(ex) {
				console.error("a", ex);
				dlg.unblock();
			});;

			//dialog.resolve(document.getElementById('name').value);
		}

		// Clicking cancel will reject and close the dialog
		function cancelClick() {
			dlg.reject();
		}



	</script>
<body>
	<label style="font-weight: bold;">Enter your name</label><br />
	<input type="text" id="name" />
	<button onclick="javascript:okClick();">ok</button>
	<button onclick="jbuttonvascript:cancelClick();">Cancel</button>

</body>
</html>