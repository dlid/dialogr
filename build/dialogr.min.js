/*! dialogr v0.0.8 © 2016 David Lidström. https://docs.dlid.se/dialogr License: MIT */
!function(e){function t(e){return"undefined"==typeof e}function n(e){return e=e||"u",A++,("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+A}function o(e){var t=parseInt(e,10);return isNaN(t)?0:t}function r(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n)for(var i in n)null===n[i]||t(n[i])?delete e[i]:n[i].constructor===Object?e[i]&&e[i].constructor!==Object?e[i]=n[i]:(e[i]=e[i]||{},r(e[i],n[i])):e[i]=n[i]}),e}function l(e){var t=[];for(var n in e.params)e.params.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e.params[n]));return t=t.length>0?"?"+t.join("&"):"",e.url+t+e.hash}function s(e){var t=e.indexOf("?"),n=e.indexOf("#"),i={url:e,hash:"",params:{}};if(n!=-1&&(i.hash=i.url.substring(n),i.url=i.url.substring(0,n)),t!=-1){var o=i.url.substring(t+1).split("&");i.url=i.url.substring(0,t);for(var r=0;r<o.length;r++){var l=o[r].split("=");2==l.length?i.params[l[0]]=l[1]:i.params[l[0]]=""}}return i}function a(e,t){var n=s(e);return n.params=r({},n.params,t),l(n)}function u(e,n,i){null===e||t(e)||(e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent?e.attachEvent("on"+n,i):e["on"+n]=i)}function d(e,t){return{t:o(h(e,t+"-top")),r:o(h(e,t+"-right")),b:o(h(e,t+"-bottom")),l:o(h(e,t+"-left"))}}function h(e,t){var n;return window.getComputedStyle?n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.currentStyle&&(n=e.currentStyle[t]),n}function f(e,t){var n,i=m(t);for(n=0;n<i.length;n++)e.style[i[n]]=t[i[n]];return e}function c(e,t){var n=0;for(n=0;n<t.length;n++)e.appendChild(t[n])}function g(e,t){var n,i=m(t);for(n=0;n<i.length;n++)e.setAttribute(i[n],t[i[n]]);return e}function p(e,t){return e.innerHTML=t,e}function m(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}function v(e,t){return document.createElement(e,t)}function b(e){function t(){n=d(e,"padding"),i=d(e,"border-width"),r=d(e,"margin"),l="border-box"===h(e,"box-sizing"),c="block"===h(e,"display"),l?(u=o(h(e,"width")),f=o(h(e,"height")),s=u-n.l-n.r-r.l-r.r-i.l-i.r,a=f-n.t-n.b-r.t-r.b-i.t-i.b):(u=o(h(e,"width"))+n.l+n.r+r.l+r.r+i.l+i.r,f=o(h(e,"height"))+n.t+n.b+r.t+r.b+i.t+i.b,s=o(h(e,"width")),a=o(h(e,"height")))}var n,i,r,l,s,a,u,f,c;return t(),{width:function(){return c?u:0},height:function(){return c?f:0},innerWidth:function(){return s},innerHeight:function(){return a},padding:n,border:i,margin:r,setWidth:function(s){s=l?o(s):o(s)-n.l-n.r-r.l-r.r-i.l-i.r,e.style.width=s+q,t()},setHeight:function(s){s=l?o(s):o(s)-n.t-n.b-r.t-r.b-i.t-i.b,e.style.height=s+q,t()},setTop:function(t){t=o(t),e.style.top=t+q},setLeft:function(t){t=o(t),e.style.left=t+q}}}function w(e,t){var n;return"function"==typeof e&&(e=e(t)),"string"==typeof e?(n=e.match(/^(\d+)\%$/))?e=Math.ceil(n[1]/100*t)+q:(n=e.match(/^(\d+)$/))&&(e=parseInt(n[1],10)+q):"number"==typeof e?e+=q:e=0,e}function y(e,t){var n=e.dialog,i=e.p,o=e.content,r=e.footer,l=e.loader,s=e.header,a=$(e,t);n.style.width=a.w,n.style.height=a.h,n.style.left=a.l,n.style.top=a.t,i.style.width=a.w,i.style.height=a.h,i.style.left=a.l,i.style.top=a.t;var u=b(n),d=b(s),h=b(o),f=b(r),c=b(l);h.setWidth(u.innerWidth());u.innerHeight()-f.height()-d.height();h.setHeight(u.innerHeight()-f.height()-d.height()),f.setTop(h.height()+d.height()),f.setWidth(u.innerWidth()),c.setTop(u.innerHeight()/2-c.height()/2),c.setLeft(u.innerWidth()/2-c.width()/2)}function $(e,t){var n=w(t.width,window.innerWidth),i=w(t.height,window.innerHeight),r=Math.ceil(window.innerWidth/2-parseInt(n,10)/2)+q,l=Math.ceil(window.innerHeight/2-parseInt(i,10)/2)+q,s=n,a=i,u=null,f=d(e.dialog,"padding"),c=d(e.dialog,"border-width"),g=d(e.dialog,"margin");return o(t.maxWidth)>0&&o(s)>parseInt(t.maxWidth)&&(n=t.maxWidth,r=Math.ceil(window.innerWidth/2-parseInt(n,10)/2)+q,u="border-box"!=h(e.dialog,"box-sizing")?o(n)+q:o(n)-f.r-f.l-c.l-c.r+q),"border-box"!=h(e.dialog,"box-sizing")&&(n=o(n)-f.l-f.r-c.l-c.r-g.l-g.r+q,i=o(i)-f.t-f.b-c.t-c.b-g.t-g.b+q),o(s)>window.innerWidth||o(a)>window.innerHeight||o(t.minWidth)>0&&o(window.innerWidth)<o(t.minWidth)||o(t.minHeight)>0&&o(window.innerHeight)<o(t.minHeight)?(n=window.innerWidth+q,i=window.innerHeight+q,r=0,l=0,u="border-box"!=h(e.dialog,"box-sizing")?o(n)-f.r+q:o(n)-f.r-f.l-c.l-c.r+q):u="border-box"!=h(e.dialog,"box-sizing")?o(n)+q:o(n)-f.r-f.l-c.l-c.r+q,{w:n,h:i,l:r,t:l,iw:u}}function I(e,i){function o(t,n){return p(g(v("button"),{id:"button_"+e+"_"+t,onclick:'dialogr.trigger("'+e+'", "button_'+t+'");',class:"dialogr__button button_"+t}),n)}function r(e){for(var n,i,r=0,l=h.querySelectorAll(".dialogr__button"),s=0;s<l.length;s++)l[s].parentNode.removeChild(l[s]);if(w=[],!t(e.buttons))if(e.buttons.constructor===Array)for(s=0;s<e.buttons.length;s++)n=o(s,e.buttons[s]),c(h,[n]),w["button_"+s]=n,r++;else if("object"==typeof e.buttons)for(i=m(e.buttons),s=0;s<i.length;s++)n=o(i[s],e.buttons[i[s]].text),c(h,[n]),w["button_"+i[s]]=n,r++;f(h,{display:0===r?"none":"block"})}var l,s,a,u,d,h,b,w=[],y=i.className;return l=f(g(v(Y),{class:y,id:n()}),{position:P,zIndex:i.zIndex,display:B}),s=g(f(v(Y),{position:P,width:"100%",backgroundColor:"rgba(0,0,0,0.5)",height:"100%",top:0,left:0,zIndex:l.style.zIndex-10}),{"data-dialogr-id":e,class:y+"__overlay"}),a=f(g(v("iframe"),{class:y+"__content"}),{position:J,display:B,visibility:V}),u=f(g(v(Y),{class:y+"__loader-overlay"}),{position:P,border:"1px solid #aaa",backgroundColor:"rgba(255,255,255,0.8)",cursor:"wait",display:B,visibility:"visible"}),d=p(f(g(v(Y),{class:y+"__overlay"}),{position:J,backgroundColor:"#fff",display:B}),"Loading..."),h=f(g(v(Y),{class:y+"__footer"}),{position:J,display:B}),b=f(g(v(Y),{class:y+"__header"}),{overflow:V,display:B}),i.title?p(b,"<a href='javascript:dialogr.close(\""+e+"\")'>x</a><h1>"+i.title+"</h1>"):f(b,{display:B}),r(i),c(u,[d]),c(l,[b,a,h,u]),{o:s,p:u,loader:d,dialog:l,header:b,footer:h,content:a,buttons:w,createButtons:r,destroy:function(){},addToDom:function(){c(document.body,[l,s])}}}function _(o,l,s,d,c){function g(){y(m,p)}var p,m={},v=this,b=null;if("string"==typeof o?((t(l)||"object"!=typeof l)&&(l={}),l.url=o):"object"==typeof o&&(l=o),p=r({},O,l),p.maxWidth=w(p.maxWidth,window.outerWidth),p.minWidth=w(p.minWidth,window.outerWidth),t(p.url))return void console.error("[dialogr] No url was given");var $=!1;d&&d!==!0?this.id=d:(M++,this.id="d"+n("dlg")+"_"+M),p.url=a(p.url,{_dialogrId:this.id}),d===!0&&($=!0),b={father:!1,mother:!1,child:!1},d===!0?(b.father=!0,b.fatherTo=this.id):t(d)?(b.mother=!0,b.motherTo=this.id,b.father=!0,b.fatherTo=this.id):(b.mother=!0,b.motherTo=this.id),p.$r=b;var _=F.Deferred(),x=new G(this.id,null,$,c);if(x.setIdentity(b),_disableScrollForElements=[],console.warn(p),b.father?x.on("$f",function(t,n,i){b.fatherTo==t.childId&&(x.setNamedTarget("child",i.source),x.send("$k",{fatherLocation:e.location.href},null,i.source))}):b.mother&&x.on("$h",function(e){m.buttons[e]&&m.buttons[e].setAttribute("disabled","disabled")}).on("$i",function(e){m.buttons[e]&&m.buttons[e].removeAttribute("disabled")}).on("$a",function(e){m.buttons[e.element]&&(m.buttons[e.element].innerText=e.value)}).on("$g",function(e){m.buttons[e.element]&&(m.buttons[e.element].innerHTML=e.value)}).on("$l",function(e){m.buttons[e.element]&&(m.buttons[e.element].innerHTML=e.value)}),x.on("$o",function(e,n,i){var o=!1,l=F.Deferred();return x.setDialogrId(v.id),x.setNamedTarget("dialog",i.source),t(e.options)||(e.options.width&&(o=!0,p.width=w(e.options.width,window.innerWidth)),e.options.height&&(o=!0,p.height=w(e.options.height,window.innerHeight)),e.options.buttons&&(o=!0,p.buttons=e.options.buttons,m.createButtons(p)),o&&y(m,p)),l.resolve(r({openerUrl:window.location.href.toString(),dialogrId:v.id,param:p.param},{opener:c})),l.promise()}),x.on("$e",function(e){_.reject(e),v.close()}),x.on("$j",function(e){_.resolve(e),v.close()}),x.on("$c",function(e,t,n){v.close()}),x.on("$b",function(){m.p.style.visibility="visible"}),x.on("$m",function(){m.p.style.visibility="hidden",m.content.style.visibility="visible"}),!d||d&&d!==!0){x.on("$n",function(e){var t=F.Deferred();dialogr.open(e.optionsOrUrl,e.options,e.newDialogId,e.openerId);return t.resolve({dialogrId:e.newDialogId}),t.promise()}),m=I(this.id,p),i=document.getElementsByTagName("html"),1==i.length&&_disableScrollForElements.push(i[0]),i=document.getElementsByTagName("body"),1==i.length&&_disableScrollForElements.push(i[0]);var W=[];for(i=0;i<_disableScrollForElements.length;i++)W.push(h(_disableScrollForElements[i],"overflow-y")),f(_disableScrollForElements[i],{"overflow-y":"hidden"});m.addToDom(),setTimeout(function(){y(m,p)},5),u(window,"resize",g),C=!0,m.content.setAttribute("src",p.url)}this.$$e=x,this.$$el=m,this.block=function(){},this.unblock=function(){},this.close=function(){if(1==K.length){console.warn("RESET STYLES",K.length,_disableScrollForElements);for(var e=0;e<_disableScrollForElements.length;e++)console.warn(e,W[e]),f(_disableScrollForElements[e],{"overflow-y":W[e]})}if(b.father&&!b.mother)x.send("$c");else if(b.mother){for(var e=0;e<K.length;e++)if(K[e].id==v.id){K.splice(e,1);break}m&&m.dialog&&m.dialog.parentNode&&m.o&&(m.dialog.parentNode.removeChild(m.dialog),m.o.parentNode.removeChild(m.o))}},this.always=_.then,this.done=_.done,this.fail=_.fail,this.then=function(e){return _.then(e),v},this.invokeAs=function(e,t,n){return x.await(e,t,null,null,n)},this.triggerAs=function(e,t,n){x.send(e,t,null,null,n)},this.trigger=function(e,t){return x.send(e,t),v},this.invoke=function(e,t){return x.await(e,t)},this.on=function(e,t){return x.on(e,t),v},K.push(this)}function x(t,n,i,o){var r=new G(null,t,(!0)),l=this,a=s(e.location.href),u=null;return a.params._dialogrId?(u=a.params._dialogrId,r.setDialogrId(u),r.await("$o",{dialogUrl:window.location.toString(),id:u,options:o},t).then(function(t){var i={child:!0,motherIdentified:!0,fatherIdentified:!0,childId:t.dialogrId};if(l.param=t.param||{},U=u,t.opener){i.fatherIdentified=!1,r.setIdentity(i),r.on("$k",function(e,t,i){r.off("$k"),r.setNamedTarget("father",i.source),l.unblock(),n(e)});for(var o=e.parent,s=0;s<o.window.frames.length;s++)r.send("$f",{frame:s,childId:u},null,o.window.frames[s])}else r.setIdentity(i),l.unblock(),n(t)},function(e){i(e)}),this.$$e=r,this.$$w=t,this.enable=function(e){},this.disable=function(e){l.trigger("$h",e)},this.addClass=function(e,t){},this.removeClass=function(e,t){},this.css=function(e,t,n){},this.attr=function(e,t,n){},this.text=function(e,t){l.trigger("$a",{element:e,value:t})},this.html=function(e,t){l.trigger("$g",{element:e,value:t})},this.on=function(e,t){return r.on(e,t),l},this.invoke=function(e,n){return r.await(e,n,null,t)},this.trigger=function(e,n){return r.send(e,n,null,t)},this.close=function(){r.send("$c")},this.block=function(){r.send("$b")},this.unblock=function(){r.send("$m")},this.resolve=function(e){r.send("$j",e)},this.reject=function(e){r.send("$e",e)},this.buttons=function(e){r.send("$l",e)},void(this.param={})):void console.error("[dialogr] _dialogrId parameter is missing. Can not create dialog context.")}function W(e,t,n){for(var i=0;i<K.length;i++)if(K[i].id==e){K[i].trigger(t,n);break}}function T(e,t,n,i){for(var o=0;o<K.length;o++)if(K[o].id==e){K[o].triggerAs(t,n,i);break}}function k(e){for(var t=0;t<K.length;t++)if(K[t].id==e)return K[t].close()}function j(e,t,n,i){for(var o=0;o<K.length;o++)if(K[o].id==e)return K[o].invokeAs(t,n,i)}function S(e,t,n){for(var i=0;i<K.length;i++)if(K[i].id==e)return K[i].invoke(t,n)}function E(t,n,i,r){var l,s=K.slice(0);if(n=n||{},R)return l=new _(t,n,{},(!0)),R.invoke("$n",{optionsOrUrl:t,options:n,newDialogId:l.id,openerId:U}).then(function(t){l.$$e.setDialogrId(l.id),l.$$e.setTargetWindow(e),l.$$e.setNamedTarget("mother",this.messageEvent.source)}),l;if(s.length>0){for(var a=0,u=0;u<s.length;u++){var d=o(h(s[u].$$el.dialog,"z-index"));d>a&&(a=d)}n.zIndex=a+10}return l=new _(t,n,{},i,r)}function D(t){var n=F.Deferred();return z=!0,N.done(function(){function i(e){n.resolve(R)}function o(e){n.reject(e)}R=new x(e.parent,i,o,t)}),n.promise()}function H(){return u(e,"keydown",function(e){27===e.keyCode&&null!==L&&k()}),{open:E,ready:D,close:k,trigger:W,invoke:S,triggerAs:T,invokeAs:j,deferred:function(){return F.Deferred()}}}var N,O={zIndex:1500,url:null,className:"dialogr",width:300,height:100,title:null,breakpointW:600,breakpointH:500,param:null,maxWidth:null,minWidth:0},A=0,C=null,z=!1,L=null,M=null,F=this,R=null,U=null,B="block",P="fixed",J="absolute",V="hidden",q="px",Y="div";!function(e){function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e,n){if(t(e))for(var i=0;i<e.length;i++)n(e[i]);else n(e)}function i(e){var o="pending",r=[],l=[],s=[],a=null,u={done:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"resolved"===o&&n[i].apply(this,a),r.push(n[i]);else"resolved"===o&&arguments[e].apply(this,a),r.push(arguments[e]);return this},fail:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"rejected"===o&&n[i].apply(this,a),l.push(n[i]);else"rejected"===o&&arguments[e].apply(this,a),l.push(arguments[e]);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"pending"===o&&s.push(n[i]);else"pending"===o&&s.push(arguments[e]);return this},then:function(){arguments.length>1&&arguments[1]&&this.fail(arguments[1]),arguments.length>0&&arguments[0]&&this.done(arguments[0]),arguments.length>2&&arguments[2]&&this.progress(arguments[2])},promise:function(e){if(null==e)return u;for(var t in u)e[t]=u[t];return e},state:function(){return o},debug:function(){console.log("[debug]",r,l,o)},isRejected:function(){return"rejected"===o},isResolved:function(){return"resolved"===o},pipe:function(e,t,o){return i(function(i){n(e,function(e){"function"==typeof e?d.done(function(){var t=e.apply(this,arguments);t&&"function"==typeof t?t.promise().then(i.resolve,i.reject,i.notify):i.resolve(t)}):d.done(i.resolve)}),n(t,function(e){"function"==typeof e?d.fail(function(){var t=e.apply(this,arguments);t&&"function"==typeof t?t.promise().then(i.resolve,i.reject,i.notify):i.reject(t)}):d.fail(i.reject)})}).promise()}},d={resolveWith:function(e){if("pending"===o){o="resolved";for(var t=a=arguments.length>1?arguments[1]:[],n=0;n<r.length;n++)r[n].apply(e,t)}return this},rejectWith:function(e){if("pending"===o){o="rejected";for(var t=a=arguments.length>1?arguments[1]:[],n=0;n<l.length;n++)l[n].apply(e,t)}return this},notifyWith:function(e){if("pending"===o)for(var t=a=arguments.length>1?arguments[1]:[],n=0;n<s.length;n++)s[n].apply(e,t);return this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},h=u.promise(d);return e&&e.apply(h,[h]),h}i.when=function(){if(arguments.length<2){var e=arguments.length?arguments[0]:void 0;return e&&"function"==typeof e.isResolved&&"function"==typeof e.isRejected?e.promise():i().resolve(e).promise()}return function(e){for(var t=i(),n=e.length,o=0,r=new Array(n),l=0;l<e.length;l++)!function(i){var l=null;e[i].done?e[i].done(function(){r[i]=arguments.length<2?arguments[0]:arguments,++o==n&&t.resolve.apply(t,r)}).fail(function(){t.reject(arguments)}):(l=e[i],e[i]=new Deferred,e[i].done(function(){r[i]=arguments.length<2?arguments[0]:arguments,++o==n&&t.resolve.apply(t,r)}).fail(function(){t.reject(arguments)}).resolve(l))}(l);return t.promise()}(arguments)},e.Deferred=i}(this);var G=function(i,o,l,s){function a(e,n){return t(I[e])&&(I[e]=[]),I[e].push(n),this}function d(e,t){return this}function h(t,n,i,o,l){var s="undefined"!=typeof o&&null!==o;i=r({await:null,messageId:null},i||{}),i.messageId||(y++,i.messageId=$+"_"+y);var a="mother",u=["$c","$b","$m","$n"];s?a="custom target window":null!==x&&(x.child?u.indexOf(t)===-1&&(a="father"):!x.mother&&x.father&&u.indexOf(t)!==-1?a="mother":(x.mother||x.father)&&(a="dialog"));var d={source:"dialogr",messageType:t,messageData:n,messageId:i.messageId,dialogrId:l?l:_,await:i.await,fromLocation:e.location.href},h=s?o:W[a];return"undefined"==typeof h||null===h?void console.error("Target window was null or undefined",a):void h.postMessage(JSON.stringify(d),"*")}function f(e){function n(t){d++,"fail"===t.type&&(g=!1),f.push(t),d===u.length&&(clearTimeout(c),h(l.messageId+"_response",{type:g?"success":"fail",response:f},null,e.source))}function o(e){c&&n({index:s,type:"success",data:e})}function r(e){c&&n({index:s,type:"fail",data:e})}if(e.source!=window){var l,s,a;try{l=JSON.parse(e.data)}catch(e){}if(l&&!t(l.source)&&"dialogr"===l.source){if(_){if(_!==l.dialogrId)return}else if(l.messageType.indexOf("$o")===-1)return;if(t(I[l.messageType]))l.await&&(console.warn("no handlers in",i,I,window.location),h(l.messageId+"_response",{type:"fail",response:["Nothing listening for '"+l.messageType+"'"]},null,e.source));else if(l.await){var u=I[l.messageType].slice(0),d=0,f=[],c=null,g=!0;for(c=setTimeout(function(){h(l.messageId+"_response",{type:"fail",response:["Operation took too long > "+l.await+"ms"]},null,e.source)},l.await),s=0;s<u.length;s++)if(a=u[s](l.messageData,l,e),l.await)if(a&&a.done&&a.fail&&a.promise)a.then(o,r);else{if(!c)return;n({apa:3,index:s,type:"success",data:a})}}else for(s=0;s<I[l.messageType].length;s++)a=I[l.messageType][s](l.messageData,l,e)}}}function c(e,t,n,i,o){var l=F.Deferred();n=r({await:5e3},n||{}),y++,n.messageId=e+"://await"+$+y,a(n.messageId+"_response",function(e,t,n){for(var i=[],o=0;o<e.response.length;o++)"string"==typeof e.response[o]?i.push(e.response[o]):e.response[o].data&&i.push(e.response[o].data);var r={messageEvent:n,message:t};"fail"===e.type?l.rejectWith(r,[1==i.length?i[0]:i]):l.resolveWith(r,[1==i.length?i[0]:i])});h(e,t,n,i,o);return l.promise()}function g(e){_=e}function p(e){b=e}function m(e){w=e}function v(e,t){"father"==e&&(x.fatherIdentified=!0),W[e]=t}var b=o||null,w=null,y=0,$=n("m"),I={},_=null,x=null,W={mother:o||null,father:o||null,child:null};return u(window,"message",f),{send:h,await:c,setDialogrId:g,setTargetWindow:p,setEventingTargetWindow:m,setNamedTarget:v,on:a,off:d,handleMessage:f,$$eventHandlers:I,setIdentity:function(e){x=e}}},K=[];N=F.Deferred(),"complete"===document.readyState?N.resolve():u(window,"load",function(){N.resolve()}),e.dialogr=H()}(window);