/*! dialogr v0.0.9 © 2017 David Lidström. https://docs.dlid.se/dialogr License: MIT */
!function(e){function t(e){return"undefined"==typeof e}function n(e){return e=e||"u",F++,("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+F}function o(e){var t=parseInt(e,10);return isNaN(t)?0:t}function r(e,t){return console.warn("Dialog",e),console.warn("Opener",t),[]}function s(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n)for(var i in n)null===n[i]||t(n[i])?delete e[i]:n[i].constructor===Object?e[i]&&e[i].constructor!==Object?e[i]=n[i]:(e[i]=e[i]||{},s(e[i],n[i])):e[i]=n[i]}),e}function l(e){var t=[];for(var n in e.params)e.params.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e.params[n]));return t=t.length>0?"?"+t.join("&"):"",e.url+t+e.hash}function a(e){var t=e.indexOf("?"),n=e.indexOf("#"),i={url:e,hash:"",params:{}};if(n!=-1&&(i.hash=i.url.substring(n),i.url=i.url.substring(0,n)),t!=-1){var o=i.url.substring(t+1).split("&");i.url=i.url.substring(0,t);for(var r=0;r<o.length;r++){var s=o[r].split("=");2==s.length?i.params[s[0]]=s[1]:i.params[s[0]]=""}}return i}function u(e){return e.constructor===Array}function d(e){console.error("[dialogr]",e)}function f(e,t){var n=a(e);return n.params=s({},n.params,t),l(n)}function h(e,n,i){null===e||t(e)||(e.addEventListener?e.addEventListener(n,i,!1):e.attachEvent?e.attachEvent("on"+n,i):e["on"+n]=i)}function c(n){return n=t(n)?e:n,n.innerWidth}function g(e,t){return{t:o(p(e,t+"-top")),r:o(p(e,t+"-right")),b:o(p(e,t+"-bottom")),l:o(p(e,t+"-left"))}}function p(e,t){var n;return window.getComputedStyle?n=document.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.currentStyle&&(n=e.currentStyle[t]),n}function m(e,t){var n,i=w(t);for(n=0;n<i.length;n++)e.style[i[n]]=t[i[n]];return e}function v(e,t){var n=0;for(n=0;n<t.length;n++)e.appendChild(t[n])}function b(e,t){var n,i=w(t);for(n=0;n<i.length;n++)e.setAttribute(i[n],t[i[n]]);return e}function y(e,t){return e.innerHTML=t,e}function w(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}function $(e,t){return document.createElement(e,t)}function I(e){function t(){n=g(e,"padding"),i=g(e,"border-width"),r=g(e,"margin"),s=p(e,X)===Q,f=p(e,"display")===B,s?(u=o(p(e,Z)),d=o(p(e,ee)),l=u-n.l-n.r-r.l-r.r-i.l-i.r,a=d-n.t-n.b-r.t-r.b-i.t-i.b):(u=o(p(e,Z))+n.l+n.r+r.l+r.r+i.l+i.r,d=o(p(e,ee))+n.t+n.b+r.t+r.b+i.t+i.b,l=o(p(e,Z)),a=o(p(e,ee)))}var n,i,r,s,l,a,u,d,f;return t(),{width:function(){return f?u:0},height:function(){return f?d:0},innerWidth:function(){return l},innerHeight:function(){return a},padding:n,border:i,margin:r,setWidth:function(l){l=s?o(l):o(l)-n.l-n.r-r.l-r.r-i.l-i.r,e.style.width=l+J,t()},setHeight:function(l){l=s?o(l):o(l)-n.t-n.b-r.t-r.b-i.t-i.b,e.style.height=l+J,t()},setTop:function(t){t=o(t),e.style.top=t+J},setLeft:function(t){t=o(t),e.style.left=t+J}}}/*! Deferred (https://github.com/warpdesign/deferred-js) */
function _(e,t){var n;return"function"==typeof e&&(e=e(t)),"string"==typeof e?(n=e.match(/^(\d+)\%$/))?e=Math.ceil(n[1]/100*t)+J:(n=e.match(/^(\d+)$/))&&(e=parseInt(n[1],10)+J):"number"==typeof e?e+=J:e=0,e}function W(e,t){var n=e.dialog,i=e.p,o=e.content,r=e.footer,s=e.loader,l=e.header,a=x(e,t);n.style.width=a.w,n.style.height=a.h,n.style.left=a.l,n.style.top=a.t,i.style.width=a.w,i.style.height=a.h,i.style.left=a.l,i.style.top=a.t;var u=I(n),d=I(l),f=I(o),h=I(r),g=I(s),p=u.innerWidth(),m=u.innerHeight(),v=h.height(),b=d.height();c(),f.setWidth(p);f.setHeight(m-v-b),h.setTop(f.height()+b),h.setWidth(p),g.setTop(m/2-g.height()/2),g.setLeft(p/2-g.width()/2)}function x(e,t){var n=_(t.width,window.innerWidth),i=_(t.height,window.innerHeight),r=Math.ceil(window.innerWidth/2-parseInt(n,10)/2)+J,s=Math.ceil(window.innerHeight/2-parseInt(i,10)/2)+J,l=n,a=i,u=null,d=g(e.dialog,"padding"),f=g(e.dialog,"border-width"),h=g(e.dialog,"margin");return o(t.maxWidth)>0&&o(l)>parseInt(t.maxWidth)&&(n=t.maxWidth,r=Math.ceil(window.innerWidth/2-parseInt(n,10)/2)+J,u=p(e.dialog,X)!=Q?o(n)+J:o(n)-d.r-d.l-f.l-f.r+J),p(e.dialog,X)!=Q&&(n=o(n)-d.l-d.r-f.l-f.r-h.l-h.r+J,i=o(i)-d.t-d.b-f.t-f.b-h.t-h.b+J),o(l)>window.innerWidth||o(a)>window.innerHeight||o(t.minWidth)>0&&o(window.innerWidth)<o(t.minWidth)||o(t.minHeight)>0&&o(window.innerHeight)<o(t.minHeight)?(n=window.innerWidth+J,i=window.innerHeight+J,r=0,s=0,u=p(e.dialog,X)!=Q?o(n)-d.r+J:o(n)-d.r-d.l-f.l-f.r+J):u=p(e.dialog,X)!=Q?o(n)+J:o(n)-d.r-d.l-f.l-f.r+J,{w:n,h:i,l:r,t:s,iw:u}}function T(e,t,n){var i=n.createElement;"function"==typeof i&&i(e,t)}function j(e,i){function o(t,n){return y(b($("button"),{id:"button_"+e+"_"+t,onclick:'dialogr.trigger("'+e+'", "button_'+t+'");',class:"dialogr__button button_"+t}),n)}function r(e){for(var n,i,r,s=0,l=f.querySelectorAll(".dialogr__button"),a=0;a<l.length;a++)l[a].parentNode.removeChild(l[a]);if(c=[],!t(e.buttons))if(e.buttons.constructor===Array)for(a=0;a<e.buttons.length;a++)n=o(a,e.buttons[a]),v(f,[n]),c["button_"+a]=n,s++;else if("object"==typeof e.buttons)for(i=w(e.buttons),a=0;a<i.length;a++)r=e.buttons[i[a]],n=o(i[a],r.text),v(f,[n]),1==r.disabled&&b(n,{disabled:"disabled"}),c["button_"+i[a]]=n,s++;return m(f,{display:0===s?"none":"block"}),c}var s,l,a,u,d,f,h,c=[],g=i.className;return s=m(b($(q),{class:g,id:n()}),{position:U,zIndex:i.zIndex,display:B}),T("dialog",s,i),l=b(m($(q),{position:U,width:"100%",backgroundColor:"rgba(0,0,0,0.5)",height:"100%",top:0,left:0,zIndex:s.style.zIndex-10}),{"data-dialogr-id":e,class:g+"__overlay"}),T("overlay",l,i),a=m(b($("iframe"),{class:g+"__content"}),{position:V,display:B,visibility:Y}),T("content",a,i),u=m(b($(q),{class:g+"__loader-overlay"}),{position:U,border:"1px solid #aaa",backgroundColor:"rgba(255,255,255,0.8)",cursor:"wait",display:B,visibility:"visible"}),T("loaderOverlay",u,i),d=y(m(b($(q),{class:g+"__overlay"}),{position:V,backgroundColor:"#fff",display:B}),i.loadingText?i.loadingText:"Loading..."),T("loader",d,i),f=m(b($(q),{class:g+"__footer"}),{position:V,display:B}),T("footer",f,i),h=m(b($(q),{class:g+"__header"}),{overflow:Y,display:B}),T("header",h,i),i.title?y(h,"<a href='javascript:dialogr.close(\""+e+"\")'>x</a><h1>"+i.title+"</h1>"):m(h,{display:B}),r(i),v(u,[d]),v(s,[h,a,f,u]),{o:l,p:u,loader:d,dialog:s,header:h,footer:f,content:a,buttons:c,createButtons:r,destroy:function(){},addToDom:function(){v(document.body,[s,l])}}}function k(e){var t,n,i=0;if(u(e.buttons)){for(n=[],t=0;t<e.buttons.length;t++){if("string"==typeof e.buttons[t])n.push({name:"b"+t,text:e.buttons[t]});else{if("object"!=typeof e.buttons[t])continue;n.push(e.buttons[t])}n[n.length-1].index||(n[n.length-1].index=i),i+=10}e.buttons=n}else d("buttons must be an array");return console.warn("refinedOptions",e),e}function E(e,o,l,a){function u(){W(v,g)}var g,v={},b=this,y=null,w=e.$$.isFather,$=e.$$.isMother,I=null;if(g=s({},N,k(e)),g.maxWidth=_(g.maxWidth,window.outerWidth),g.minWidth=_(g.minWidth,window.outerWidth),t(g.url))return void d()("[dialogr] No url was given");var x=w&&!$;I=e.$$.id||null,I||(M++,I="d"+n("dlg")+"_"+M),this.id=I,g.url=f(g.url,{_dialogrId:this.id}),y={father:w,mother:$,child:!1},w&&(y.fatherTo=I),$&&(y.motherTo=I),g.$r=y;var T=L.Deferred(),E=new te(I,null,x,a);E.setIdentity(y),_disableScrollForElements=[],y.father&&E.on("$f",function(e,t,n){y.fatherTo==e.childId&&(E.setNamedTarget("child",n.source),E.send("$k",null,null,n.source))}),y.mother&&E.on("$h",function(e){v.buttons[e]&&v.buttons[e].setAttribute(K,K)}).on("$i",function(e){v.buttons[e]&&v.buttons[e].removeAttribute(K)}).on("$a",function(e){v.buttons[e.element]&&(v.buttons[e.element].innerText=e.value)}).on("$g",function(e){v.buttons[e.element]&&(v.buttons[e.element].innerHTML=e.value)}).on("$l",function(e){v.buttons[e.element]&&(v.buttons[e.element].innerHTML=e.value)}),E.on("$o",function(e,n,i){if(I==e.id){var o=!1,l=L.Deferred();E.setDialogrId(b.id),E.setNamedTarget("dialog",i.source),t(e.options)||(e.options.width&&!g.$$.raw.width&&(o=!0,g.width=_(e.options.width,c())),e.options.height&&!g.$$.raw.height&&(o=!0,g.height=_(e.options.height,c())),g.buttons&&(r(e.options.buttons,g.buttons),e.options.buttons=s({},e.options.buttons,g.buttons)),e.options.buttons&&(o=!0,g.buttons=e.options.buttons,v.buttons=v.createButtons(g)),o&&W(v,g));var u=g.param;return!t(u)&&u.param&&(u=u.param),l.resolve(s({openerUrl:window.location.href.toString(),dialogrId:b.id,param:u},{opener:a})),l.promise()}}),E.on("$e",function(e){T.reject(e),b.close()}),E.on("$j",function(e){T.resolve(e),b.close()}),E.on("$c",function(e,t,n){b.close()}),E.on("$b",function(){v.p.style.visibility=P}),E.on("$m",function(){v.p.style.visibility=Y,v.content.style.visibility=P}),$&&(E.on("$n",function(e){var t=L.Deferred();e.options.$$.isMother=!0,e.options.$$.isFather=!1;dialogr.open(e.options,e.newDialogId,e.openerId);return t.resolve({dialogrId:e.newDialogId}),t.promise()}),O.done(function(){console.warn("DOM Ready! Create elements"),v=j(I,g),i=document.getElementsByTagName("html"),1==i.length&&_disableScrollForElements.push(i[0]),i=document.getElementsByTagName("body"),1==i.length&&_disableScrollForElements.push(i[0]);var e=[];for(i=0;i<_disableScrollForElements.length;i++)e.push(p(_disableScrollForElements[i],G)),m(_disableScrollForElements[i],{STYLE_OVERFLOW_Y:Y});v.addToDom(),W(v,g),h(window,"resize",u),A=!0,v.content.setAttribute("src",g.url)})),this.$$e=E,this.$$el=v,this.block=function(){},this.unblock=function(){},this.close=function(){if(1==ne.length)for(var e=0;e<_disableScrollForElements.length;e++)m(_disableScrollForElements[e],{STYLE_OVERFLOW_Y:_originalStyles[e]});if(y.father&&!y.mother)E.send("$c");else if(y.mother){for(var e=0;e<ne.length;e++)if(ne[e].id==b.id){ne.splice(e,1);break}v&&v.dialog&&v.dialog.parentNode&&v.o&&(v.dialog.parentNode.removeChild(v.dialog),v.o.parentNode.removeChild(v.o))}},this.always=T.then,this.done=T.done,this.fail=T.fail,this.then=function(e){return T.then(e),b},this.invokeAs=function(e,t,n){return E.await(e,t,null,null,n)},this.triggerAs=function(e,t,n){E.send(e,t,null,null,n)},this.trigger=function(e,t){return E.send(e,t),b},this.invoke=function(e,t){return E.await(e,t)},this.on=function(e,t){return E.on(e,t),b},ne.push(this)}function D(t,n,i,o){var r=new te(null,t,(!0)),l=this,u=a(e.location.href),d=null;return u.params._dialogrId?(d=u.params._dialogrId,r.setDialogrId(d),o=k(o),r.await("$o",{dialogUrl:window.location.toString(),id:d,options:o},t).then(function(t){var i={child:!0,motherIdentified:!0,fatherIdentified:!0,childId:t.dialogrId};if(l.param=s({},u.params,t.param||{}),R=d,t.opener){i.fatherIdentified=!1,r.setIdentity(i),r.on("$k",function(e,t,i){r.off("$k"),r.setNamedTarget("father",i.source),l.unblock(),n(e)});for(var o=e.parent,a=0;a<o.window.frames.length;a++)r.send("$f",{frame:a,childId:d},null,o.window.frames[a])}else r.setIdentity(i),l.unblock(),n(t)},function(e){i(e)}),this.$$e=r,this.$$w=t,this.enable=function(e){l.trigger("$i",e)},this.disable=function(e){l.trigger("$h",e)},this.addClass=function(e,t){},this.removeClass=function(e,t){},this.css=function(e,t,n){},this.attr=function(e,t,n){},this.text=function(e,t){l.trigger("$a",{element:e,value:t})},this.html=function(e,t){l.trigger("$g",{element:e,value:t})},this.on=function(e,t){return r.on(e,t),l},this.invoke=function(e,n){return r.await(e,n,null,t)},this.trigger=function(e,n){return r.send(e,n,null,t)},this.close=function(){r.send("$c")},this.block=function(){r.send("$b")},this.unblock=function(){r.send("$m")},this.resolve=function(e){r.send("$j",e)},this.reject=function(e){r.send("$e",e)},this.buttons=function(e){r.send("$l",e)},void(this.param={})):void console.error("[dialogr] _dialogrId parameter is missing. Can not create dialog context.")}function S(){function t(e,t,n){for(var i=0;i<ne.length;i++)if(ne[i].id==e){ne[i].trigger(t,n);break}}function n(e,t,n,i){for(var o=0;o<ne.length;o++)if(ne[o].id==e){ne[o].triggerAs(t,n,i);break}}function i(e){for(var t=0;t<ne.length;t++)if(ne[t].id==e)return ne[t].close()}function r(e,t,n,i){for(var o=0;o<ne.length;o++)if(ne[o].id==e)return ne[o].invokeAs(t,n,i)}function l(e,t,n){for(var i=0;i<ne.length;i++)if(ne[i].id==e)return ne[i].invoke(t,n)}function a(e){return s({$$:{isFather:!0,isMother:!0,id:null,byFather:!1,raw:s({},e)}},e)}function u(e){var t,n={},i=e.length;return i>0&&(t=typeof e[0],"string"===t?(n.url=e[0],i>1&&(n.param=e[1],i>2&&(n=s({},e[2],n)))):"object"===t&&(n=e[0])),n}function d(t){t=u(arguments);var n=null,i=null;t=a(t),t.$$.byFather!==!1&&(i=t.$$.byFather,n=t.$$.id);var r,l=ne.slice(0);if(t=t||{},z)return t.$$.isMother=!1,r=new E(t,{},(!0)),z.invoke("$n",{options:s({},t,{$$:{id:r.id,byFather:R}}),newDialogId:r.id,openerId:R}).then(function(t){r.$$e.setDialogrId(r.id),r.$$e.setTargetWindow(e),r.$$e.setNamedTarget("mother",this.messageEvent.source)}),r;if(l.length>0){for(var d=0,f=0;f<l.length;f++){var h=o(p(l[f].$$el.dialog,"z-index"));h>d&&(d=h)}t.zIndex=d+10}return r=new E(t,{},n,i)}function f(t){var n=L.Deferred();return C=!0,O.done(function(){function i(e){n.resolve(z)}function o(e){n.reject(e)}z=new D(e.parent,i,o,t)}),n.promise()}return h(e,"keydown",function(e){27===e.keyCode&&null!==H&&i()}),{open:d,ready:f,close:i,trigger:t,invoke:l,triggerAs:n,invokeAs:r,deferred:function(){return L.Deferred()}}}var O,N={zIndex:1500,url:null,className:"dialogr",width:300,height:100,title:null,breakpointW:600,breakpointH:500,param:null,maxWidth:null,minWidth:0},F=0,A=null,C=!1,H=null,M=null,L=this,z=null,R=null,B="block",U="fixed",V="absolute",Y="hidden",P="visible",J="px",q="div",G="overflow-y",K="disabled",Q="border-box",X="box-sizing",Z="width",ee="height";!function(e){function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e,n){if(t(e))for(var i=0;i<e.length;i++)n(e[i]);else n(e)}function i(e){var o="pending",r=[],s=[],l=[],a=null,u={done:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"resolved"===o&&n[i].apply(this,a),r.push(n[i]);else"resolved"===o&&arguments[e].apply(this,a),r.push(arguments[e]);return this},fail:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"rejected"===o&&n[i].apply(this,a),s.push(n[i]);else"rejected"===o&&arguments[e].apply(this,a),s.push(arguments[e]);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var e=0;e<arguments.length;e++)if(arguments[e])if(t(arguments[e]))for(var n=arguments[e],i=0;i<n.length;i++)"pending"===o&&l.push(n[i]);else"pending"===o&&l.push(arguments[e]);return this},then:function(){arguments.length>1&&arguments[1]&&this.fail(arguments[1]),arguments.length>0&&arguments[0]&&this.done(arguments[0]),arguments.length>2&&arguments[2]&&this.progress(arguments[2])},promise:function(e){if(null==e)return u;for(var t in u)e[t]=u[t];return e},state:function(){return o},debug:function(){console.log("[debug]",r,s,o)},isRejected:function(){return"rejected"===o},isResolved:function(){return"resolved"===o},pipe:function(e,t,o){return i(function(i){n(e,function(e){"function"==typeof e?d.done(function(){var t=e.apply(this,arguments);t&&"function"==typeof t?t.promise().then(i.resolve,i.reject,i.notify):i.resolve(t)}):d.done(i.resolve)}),n(t,function(e){"function"==typeof e?d.fail(function(){var t=e.apply(this,arguments);t&&"function"==typeof t?t.promise().then(i.resolve,i.reject,i.notify):i.reject(t)}):d.fail(i.reject)})}).promise()}},d={resolveWith:function(e){if("pending"===o){o="resolved";for(var t=a=arguments.length>1?arguments[1]:[],n=0;n<r.length;n++)r[n].apply(e,t)}return this},rejectWith:function(e){if("pending"===o){o="rejected";for(var t=a=arguments.length>1?arguments[1]:[],n=0;n<s.length;n++)s[n].apply(e,t)}return this},notifyWith:function(e){if("pending"===o)for(var t=a=arguments.length>1?arguments[1]:[],n=0;n<l.length;n++)l[n].apply(e,t);return this},resolve:function(){return this.resolveWith(this,arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},f=u.promise(d);return e&&e.apply(f,[f]),f}i.when=function(){if(arguments.length<2){var e=arguments.length?arguments[0]:void 0;return e&&"function"==typeof e.isResolved&&"function"==typeof e.isRejected?e.promise():i().resolve(e).promise()}return function(e){for(var t=i(),n=e.length,o=0,r=new Array(n),s=0;s<e.length;s++)!function(i){var s=null;e[i].done?e[i].done(function(){r[i]=arguments.length<2?arguments[0]:arguments,++o==n&&t.resolve.apply(t,r)}).fail(function(){t.reject(arguments)}):(s=e[i],e[i]=new Deferred,e[i].done(function(){r[i]=arguments.length<2?arguments[0]:arguments,++o==n&&t.resolve.apply(t,r)}).fail(function(){t.reject(arguments)}).resolve(s))}(s);return t.promise()}(arguments)},e.Deferred=i}(this);var te=function(i,o,r,l){function a(e,n){return t(I[e])&&(I[e]=[]),I[e].push(n),this}function u(e,t){return this}function d(t,n,i,o,r){var l="undefined"!=typeof o&&null!==o;i=s({await:null,messageId:null},i||{}),i.messageId||(w++,i.messageId=$+"_"+w);var a="mother",u=["$c","$b","$m","$n"];l?a="custom target window":null!==W&&(W.child?u.indexOf(t)===-1&&(a="father"):!W.mother&&W.father&&u.indexOf(t)!==-1?a="mother":(W.mother||W.father)&&(a="dialog"));var d={source:"dialogr",messageType:t,messageData:n,messageId:i.messageId,dialogrId:r?r:_,await:i.await,fromLocation:e.location.href},f=l?o:x[a];return"undefined"==typeof f||null===f?void console.error("Target window was null or undefined",a):void f.postMessage(JSON.stringify(d),"*")}function f(e){function n(t){f++,"fail"===t.type&&(g=!1),h.push(t),f===u.length&&(clearTimeout(c),d(s.messageId+"_response",{type:g?"success":"fail",response:h},null,e.source))}function o(e){c&&n({index:l,type:"success",data:e})}function r(e){c&&n({index:l,type:"fail",data:e})}if(e.source!=window){var s,l,a;try{s=JSON.parse(e.data)}catch(e){}if(s&&!t(s.source)&&"dialogr"===s.source){if(_){if(_!==s.dialogrId)return}else if(s.messageType.indexOf("$o")===-1)return;if(t(I[s.messageType]))s.await&&(console.warn("no handlers in",i,I,window.location),d(s.messageId+"_response",{type:"fail",response:["Nothing listening for '"+s.messageType+"'"]},null,e.source));else if(s.await){var u=I[s.messageType].slice(0),f=0,h=[],c=null,g=!0;for(c=setTimeout(function(){d(s.messageId+"_response",{type:"fail",response:["Operation took too long > "+s.await+"ms"]},null,e.source)},s.await),l=0;l<u.length;l++)if(a=u[l](s.messageData,s,e),s.await)if(a&&a.done&&a.fail&&a.promise)a.then(o,r);else{if(!c)return;n({apa:3,index:l,type:"success",data:a})}}else for(l=0;l<I[s.messageType].length;l++)a=I[s.messageType][l](s.messageData,s,e)}}}function c(e,t,n,i,o){var r=L.Deferred();n=s({await:5e3},n||{}),w++,n.messageId=e+"://await"+$+w,a(n.messageId+"_response",function(e,t,n){for(var i=[],o=0;o<e.response.length;o++)"string"==typeof e.response[o]?i.push(e.response[o]):e.response[o].data&&i.push(e.response[o].data);var s={messageEvent:n,message:t};"fail"===e.type?r.rejectWith(s,[1==i.length?i[0]:i]):r.resolveWith(s,[1==i.length?i[0]:i])});d(e,t,n,i,o);return r.promise()}function g(e){_=e}function p(e){b=e}function m(e){y=e}function v(e,t){"father"==e&&(W.fatherIdentified=!0),x[e]=t}var b=o||null,y=null,w=0,$=n("m"),I={},_=null,W=null,x={mother:o||null,father:o||null,child:null};return h(window,"message",f),{send:d,await:c,setDialogrId:g,setTargetWindow:p,setEventingTargetWindow:m,setNamedTarget:v,on:a,off:u,handleMessage:f,$$eventHandlers:I,setIdentity:function(e){W=e}}},ne=[];O=L.Deferred(),"complete"===document.readyState?O.resolve():h(window,"load",function(){O.resolve()}),e.dialogr=S()}(window);